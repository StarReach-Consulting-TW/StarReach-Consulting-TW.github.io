<!doctype html>
<html lang="zh-Hant">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>é åŒ—æ˜Ÿç¿</title>
    <style>
        :root{
         --bg:#f5f7fb; --card:#ffffff; --muted:#7a7f86; --accent:#2b8cff; --danger:#ff6b6b;
         font-family: "Noto Sans TC", "Helvetica Neue", Arial, sans-serif;
        }
        body{margin:0;background:linear-gradient(180deg,#eef3ff 0%,var(--bg) 100%);color:#111;}
        header{background:#1f2a44;color:#fff;padding:20px 18px;display:flex;align-items:center;gap:14px;}
        header .logo{width:48px;height:48px;border-radius:8px;background:linear-gradient(135deg,#2b8cff 0%,#0047b3 100%);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:24px;box-shadow:0 4px 14px rgba(0,0,0,.12)}
        header h1{margin:0;font-size:20px;letter-spacing:1px}
        .container{max-width:980px;margin:18px auto;padding:0 16px;}
        .toolbar{display:flex;gap:12px;align-items:center;margin:12px 0}
        .search{flex:1;display:flex;gap:8px}
        input[type="search"]{flex:1;padding:10px 12px;border-radius:8px;border:1px solid #dee6f5;background:#fff}
        button{padding:10px 12px;border-radius:8px;border:0;background:var(--accent);color:#fff;cursor:pointer}
        .layout{display:grid;grid-template-columns:320px 1fr;gap:18px}
        .card{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 6px 18px rgba(17,24,39,.06)}
        .group-info h2{margin:0 0 6px 0}
        .badge{display:inline-block;padding:6px 8px;border-radius:999px;background:#eef5ff;color:var(--accent);font-weight:600;font-size:13px}
        
        /* ğŸŒŸ ä¿®æ”¹é» 1: è®“è²¼æ–‡å…§çš„ tag ç¹¼æ‰¿é è¨­è—è‰²ï¼Œä¸¦ä¿æŒå¯é»æ“Š */
        .post .content .badge{cursor:pointer}
        aside .badge{cursor:pointer} /* ğŸŒŸ æ–°å¢ï¼šè®“å´é‚Šæ¬„ tag ä¹Ÿæœ‰é»æ“Šæ¸¸æ¨™ */

        .new-post{display:flex;gap:10px;align-items:flex-start}
        .avatar{width:44px;height:44px;border-radius:8px;background:#eee;display:flex;align-items:center;justify-content:center;font-weight:700;color:#666}
        textarea{width:95%;min-height:78px;padding:10px;border-radius:10px;border:1px solid #e6edf8;resize:vertical}
        .meta{display:flex;gap:8px;align-items:center;margin-top:8px}
        .posts{display:flex;flex-direction:column;gap:12px}
        .post{padding:12px;border-radius:10px;border:1px solid #f0f3fb;background:linear-gradient(180deg,#fff,#fbfdff)}
        .post .top{display:flex;gap:10px;align-items:center}
        .post .who{font-weight:700}
        .post .time{color:var(--muted);font-size:13px;margin-left:6px}
        .post .content{margin:8px 0;color:#222;white-space:pre-wrap;line-height:1.6}
        .actions{display:flex;gap:12px;align-items:center;color:var(--muted);font-size:14px}
        .actions button{background:transparent;border:0;color:var(--muted);cursor:pointer;padding:6px;border-radius:8px}
        .like.active{color:var(--accent);font-weight:700}
        .reply-list{margin-top:8px;padding-left:48px;display:flex;flex-direction:column;gap:6px}
        .reply{background:#f7f9ff;border-radius:8px;padding:8px;font-size:14px;color:#333}
        footer{margin:26px 0 60px 0;color:var(--muted);text-align:center}
        
        /* ğŸŒŸ æ–°å¢é» 2: ç¯©é¸æ¢ä»¶é¡¯ç¤ºå€å¡Šçš„æ¨£å¼ */
        .filter-container {
            display: none; /* é è¨­éš±è— */
            align-items: center;
            gap: 8px;
            background: var(--card);
            padding: 10px 12px;
            border-radius: 10px;
            margin-top: 12px;
            border: 1px solid #eef5ff;
        }
        .filter-container span:first-child {
            color: var(--muted);
            font-size: 14px;
            font-weight: 600;
        }
        .filter-container .cancel-btn {
            background: var(--muted);
            color: white;
            border: 0;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            cursor: pointer;
            font-weight: 700;
            padding: 0;
            margin-left: auto; /* æ¨åˆ°æœ€å³é‚Š */
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }
        .filter-container .cancel-btn:hover {
            background: var(--danger);
        }

        @media(max-width:860px){.layout{grid-template-columns:1fr} .toolbar{flex-direction:column;align-items:stretch}}
    </style>
</head>

<body>
    <header>
        <div class="logo">âœ¨</div>
        <div>
            <h1>é åŒ—æ˜Ÿç¿</h1>
            <div style="font-size:13px;color:rgba(255,255,255,.85)">åŒ¿åç™¼æ´©ã€è·å ´å¿ƒå¾—ã€è¾¦å…¬å®¤å°åŠ‡å ´</div>
        </div>
    </header>

    <main class="container">
        <div class="toolbar">
            <div class="search">
                <input id="q" type="search" placeholder="æœå°‹è²¼æ–‡æˆ–åŒäº‹..." />
                <button id="btnSearch">æœå°‹</button>
            </div>
            <button id="btnNew">ç™¼è¡¨åŒ¿ååæ§½</button>
        </div>

        <div class="layout">
            <aside>
                <div class="card group-info">
                    <h2>ç¤¾åœ˜ç°¡ä»‹</h2>
                    <div class="badge">åŒ¿åç¤¾åœ˜</div>
                    <p style="color:var(--muted);margin-top:10px">æ­¡è¿æŠŠè·å ´ä¸­æƒ³èªªçš„è©±ã€å¥½ç¬‘çš„æ—¥å¸¸ä¸Ÿä¸Šä¾†â€”ä¿æŒç¦®è²Œä½†èª å¯¦ã€‚</p>
                </div>

                <div class="card" style="margin-top:12px">
                    <h3 style="margin:0 0 8px 0">ç†±é–€æ¨™ç±¤</h3>
                    <div style="display:flex;flex-wrap:wrap;gap:8px">
                        <span class="badge">#è–ªæ°´å°å·</span>
                        <span class="badge">#æœƒè­°åœ°ç„</span>
                        <span class="badge">#è¾¦å…¬å®¤æŠ“é¦¬</span>
                        <span class="badge">#åˆé¤åƒä»€éº¼</span>
						<span class="badge">#æˆ‘çš„è‚</span>
						<span class="badge">#è³‡è¨Šæ–·å±¤</span>
                    </div>
                </div>
            </aside>

            <section>
                <div class="card">
                    <div class="new-post">
                        <div class="avatar">ä½ </div>
                        <div style="flex:1">
                            <textarea id="postText" placeholder="èªªå‡ºä½ å¿ƒè£¡çš„é‚£å¥é åŒ—â€¦ï¼ˆåŒ¿åï¼‰"></textarea>
                            <div class="meta">
                                <label style="color:var(--muted);font-size:13px">åˆ†é¡ï¼š
                                    <select id="category" style="margin-left:8px;padding:6px;border-radius:8px;border:1px solid #e6edf8">
                                        <option>è¾¦å…¬å®¤æŠ“é¦¬</option>
                                        <option>æœƒè­°åœ°ç„</option>
										<option>ç°¡å ±PPT</option>
                                        <option>é›·åŒ…</option>
                                        <option>è–ªæ°´å°å·</option>
										<option>åæ§½</option>
										<option>è³‡è¨Šæ–·å±¤</option>
										<option>æˆ‘çš„è‚</option>
										<option>è²¬ä»»åˆ¶æ˜¯å€‹ç¬‘è©±</option>
										<option>åšåŠŸå¾·</option>
										<option>åˆé¤åƒä»€éº¼</option>
										<option>æ‘¸é­š</option>
										<option>æ˜ŸæœŸä¸€ç—‡å€™ç¾¤</option>
                                    </select>
                                </label>
                                <div style="flex:1"></div>
                                <button id="postBtn">ç™¼ä½ˆ</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="filter-display" class="filter-container"></div>

                <div id="posts" class="posts" style="margin-top:12px">
                    </div>

            </section>
        </div>

        <footer>é åŒ—æ˜Ÿç¿ Â· åªåšåŒ¿åç™¼æ´©ï¼Œä¸è² ä»»ä½•æ³•å¾‹è²¬ä»»ï¼ˆç©ç¬‘è©±å‹¿ç•¶çœŸï¼‰</footer>
    </main>

    <script>
        // ç¯„ä¾‹è²¼æ–‡
        const sample = [
Â  Â  Â  Â  Â  {who:'é åŒ—æ˜Ÿç¿ 9486', text:'#è–ªæ°´å°å·\næˆ‘å€‘éƒ¨é–€ä¸æ˜¯äººå°‘ï¼Œæ˜¯å› ç‚ºæœ‰äº›äººä¸€å¤©åªå‡ºç¾äºŒååˆ†é˜ï¼Œæ‰€ä»¥çœ‹èµ·ä¾†åƒå¤šã€‚', time:'å‰›å‰›', likes:3, replies:[]},
Â  Â  Â  Â  Â  {who:'é åŒ—æ˜Ÿç¿ 9485', text:'#æœƒè­°åœ°ç„\næˆ‘ä¸æ˜¯ä¸æƒ³é–‹æœƒï¼Œæ˜¯æˆ‘æ‡·ç–‘ä¸€æ—¦é–‹å§‹ï¼Œä»–æœƒè¬›åˆ°é€£æˆ‘çš„éˆé­‚éƒ½è¦åŠ ç­ã€‚', time:'5åˆ†é˜å‰', likes:5, replies:[]},
Â  Â  Â  Â  Â  {who:'é åŒ—æ˜Ÿç¿ 9484', text:'#è¾¦å…¬å®¤æŠ“é¦¬\næŸäººæ¯æ¬¡èªªã€Œæˆ‘ä¾†è™•ç†ã€éƒ½åƒè©é¨™ç°¡è¨Šï¼Œæˆ‘éƒ½æœƒå…ˆæˆªåœ–å­˜è­‰ã€‚', time:'10åˆ†é˜å‰', likes:6, replies:[]},
Â  Â  Â  Â  Â  {who:'é åŒ—æ˜Ÿç¿ 9483', text:'#é›·åŒ…\nä»–é‚£å€‹ç¬‘å®¹å–”â€¦â€¦ä¸€çœ‹å°±æ˜¯ã€Œæƒ³æ‹œè¨—ä½ å¹«å¿™ä½†è£æˆæ²’äº‹ã€çš„é å…†ã€‚', time:'15åˆ†é˜å‰', likes:2, replies:[]},
Â  Â  Â  Â  Â  {who:'é åŒ—æ˜Ÿç¿ 9482', text:'#è²¬ä»»åˆ¶æ˜¯å€‹ç¬‘è©±\næˆ‘æœ€å®³æ€•çš„ä¸æ˜¯å·¥ä½œé‡ï¼Œè€Œæ˜¯æœ‰äººçªç„¶èªªã€Œç­‰ä¸€ä¸‹ï¼Œæˆ‘æƒ³åˆ°ä¸€å€‹æ›´å¥½çš„åšæ³•ã€ã€‚', time:'20åˆ†é˜å‰', likes:4, replies:[]},
Â  Â  Â  Â  Â  {who:'é åŒ—æ˜Ÿç¿ 9481', text:'#æˆ‘çš„è‚\næˆ‘å€‘é–‹ç™¼éƒ¨çš„ç²¾ç¥åœ–é¨°å°±æ˜¯ï¼šä¸ç®¡åšå°åšéŒ¯ï¼Œå…ˆè¢«ç½µå†èªªã€‚', time:'30åˆ†é˜å‰', likes:1, replies:[]},
Â  Â  Â  Â  Â  {who:'é åŒ—æ˜Ÿç¿ 9480', text:'#åˆé¤åƒä»€éº¼\næ¯å¤©ä¸­åˆå•ä¸€æ¬¡ã€Œä»Šå¤©è¦åƒä»€éº¼ã€çš„å¾ªç’°ï¼Œæ¶ˆè€—çš„è…¦åŠ›æ¯”å¯«ç¨‹å¼ç¢¼é‚„å¤šã€‚', time:'æ˜¨å¤©æ—©ä¸Š 11:30', likes:7, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9479', text:'#ç°¡å ±PPT\nè€é—†æ¯æ¬¡éƒ½èªªä»–å–œæ­¡ç°¡æ½”æœ‰åŠ›ï¼Œä½†æˆ‘çš„ 30 é  PPT ä¸€æ‹¿å‡ºä¾†ï¼Œä»–å°±é–‹å§‹å•èªªï¼šã€Œç‚ºä»€éº¼æ²’æœ‰å‹•ç•«æ•ˆæœï¼Ÿã€', time:'æ˜¨å¤©æ™šä¸Š 9:00', likes:9, replies:[]},
Â  Â  Â  Â  Â  {who:'é åŒ—æ˜Ÿç¿ 9478', text:'#æˆ‘çš„è‚ #è²¬ä»»åˆ¶æ˜¯å€‹ç¬‘è©±\nç•¶ä½ ç™¼ç¾ä½ çš„å’–å•¡æ¯è®Šæˆå…¬å¸çš„è±¡å¾µç‰©æ™‚ï¼Œå°±çŸ¥é“ä½ çš„å·¥ä½œå·²ç¶“ä¸æ˜¯å·¥ä½œï¼Œæ˜¯ä¿¡ä»°äº†ã€‚', time:'æ˜¨å¤©ä¸­åˆ 12:00', likes:12, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9477', text:'#è¾¦å…¬å®¤æŠ“é¦¬\néš”å£éƒ¨é–€çš„ A è½åˆ° B è·Ÿä¸»ç®¡æŠ±æ€¨ï¼ŒB æ²’æŠ±æ€¨ Cï¼Œçµæœ A è·‘å»è·Ÿ C èªª B åœ¨æŠ±æ€¨ä»–ã€‚æˆ‘åªæ˜¯ä¸€å€‹æ—è§€è€…ï¼Œè¬è¬ã€‚', time:'æ˜¨å¤©æ™šä¸Š 7:30', likes:5, replies:[]},
Â  Â  Â  Â  Â  {who:'é åŒ—æ˜Ÿç¿ 9476', text:'#è³‡è¨Šæ–·å±¤\nä¸»ç®¡ï¼šã€Œé€™ä»¶äº‹æˆ‘ä¹‹å‰åœ¨é›»æ¢¯è£¡æéã€‚ã€ æˆ‘ï¼šï¼Ÿï¼Ÿï¼Ÿ', time:'æ˜¨å¤©ä¸‹åˆ 4:45', likes:15, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9475', text:'#åˆé¤åƒä»€éº¼\næ¯å¤©åˆé¤éƒ½åƒåœ¨ç©è¼ªç›¤ï¼Œä»Šå¤©è³­è¼¸äº†ï¼Œåªå¥½ä¸‹åˆæ€’å–ä¸€æ¯çå¥¶å®‰æ…°è‡ªå·±ã€‚', time:'æ˜¨å¤©ä¸­åˆ 11:50', likes:8, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9474', text:'#è–ªæ°´å°å·\néš”å£è€ç‹å·¥ä½æ°¸é ç©ºè‘—ï¼Œä½†ä»–äº¤æ¥æ™‚æª”æ¡ˆæ°¸é æ˜¯æœ€å¤šçš„ï¼Œé€™æ‰æ˜¯çœŸæ­£çš„æ™‚é–“ç®¡ç†å¤§å¸«ã€‚', time:'å‰å¤©ä¸‹åˆ 5:00', likes:11, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9473', text:'#åšåŠŸå¾·\nå·²ç¶“é€£çºŒä¸‰å¤©è¢«å‡¹åšéè·è²¬å…§çš„å·¥ä½œäº†ã€‚æˆ‘ä¸Šè¼©å­æ˜¯ç‡’äº†å¤šå¤§çš„é¦™ï¼Œé€™è¼©å­ä¾†ç•¶æ´»è©è–©ï¼Ÿ', time:'å‰å¤©æ™šä¸Š 8:30', likes:13, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9472', text:'#æ‘¸é­š\nå·å·åœ¨é›»è…¦ä¸Šé–‹äº†ä¸€å€‹Excelï¼Œå‡è£åœ¨èªçœŸçœ‹æ•¸æ“šï¼Œå…¶å¯¦åœ¨çœ‹å½±ç‰‡ã€‚è€é—†ç¶“éè¨˜å¾—åˆ‡æ›è¦–çª—ï¼', time:'å‰å¤©ä¸Šåˆ 10:30', likes:7, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9471', text:'#é›·åŒ…\næŸåŒäº‹èªªè¦å¹«å¿™ï¼Œçµæœæ˜¯å¹«å€’å¿™ï¼Œç¾åœ¨æˆ‘è¦èŠ±é›™å€æ™‚é–“ä¾†ä¿®å¾©ä»–é€ æˆçš„ã€Œè²¢ç»ã€ã€‚', time:'å‰å¤©æ™šä¸Š 7:00', likes:9, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9470', text:'#æœƒè­°åœ°ç„\né–‹æœƒæ™‚ï¼Œä¸»ç®¡æ°¸é æŠŠã€Œé›†æ€å»£ç›Šã€è¬›æˆã€Œæˆ‘èªªä»€éº¼ä½ å€‘å°±èªªå¥½ã€ã€‚', time:'ä¸Šé€±äº”ä¸‹åˆ 3:00', likes:18, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9469', text:'#è¾¦å…¬å®¤æŠ“é¦¬\nç¸½å‹™éƒ¨é–€çš„é‚£å€‹å’–å•¡æ©Ÿä¹‹æˆ°å·²ç¶“æŒçºŒä¸‰å¹´äº†ï¼Œåˆ°åº•èª°è©²è² è²¬è£œå’–å•¡è±†ï¼Ÿæ¯å¤©æ—©ä¸Šéƒ½åƒä¸€å ´ç”Ÿå­˜éŠæˆ²ã€‚', time:'ä¸Šé€±å››ä¸Šåˆ 9:30', likes:4, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9468', text:'#æˆ‘çš„è‚\né€±æœ«è¢«é€šçŸ¥è¦ç·Šæ€¥è™•ç†å•é¡Œï¼Œæˆ‘åªæ˜¯æƒ³çŸ¥é“ï¼Œé€™ä»½è–ªæ°´åˆ°åº•æœ‰æ²’æœ‰åŒ…å«æˆ‘çš„éˆé­‚ï¼Ÿ', time:'ä¸Šé€±ä¸‰æ™šä¸Š 10:00', likes:16, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9467', text:'#æ˜ŸæœŸä¸€ç—‡å€™ç¾¤\né¬§é˜éŸ¿çš„é‚£ä¸€åˆ»ï¼Œæˆ‘çªç„¶ç†è§£äº†ã€Œäººç”Ÿå¦‚æˆ²ï¼Œå…¨é æ¼”æŠ€ã€çš„çœŸè«¦ã€‚', time:'ä¸Šé€±ä¸€æ—©ä¸Š 7:00', likes:20, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9466', text:'#è³‡è¨Šæ–·å±¤\næ˜¨å¤©å‰›æŠŠæ–‡ä»¶ç™¼çµ¦å…¨çµ„ï¼Œä»Šå¤©ä¸»ç®¡å°±å•æˆ‘ï¼šã€Œé€™ä»¶äº‹ç‚ºä»€éº¼æ²’æœ‰ä»»ä½•æ›¸é¢ç´€éŒ„ï¼Ÿã€', time:'ä¸Šé€±äºŒä¸‹åˆ 2:00', likes:6, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9465', text:'#è–ªæ°´å°å·\næœ‰äº›åŒäº‹åœ¨å…¬å¸æ´»å¾—åƒç¨€æœ‰å‹•ç‰©ï¼Œä¸‰å€‹æœˆçœ‹åˆ°ä¸€æ¬¡é‚„æœƒæ‡·ç–‘æ˜¯å¹»è¦ºã€‚', time:'ä¸Šé€±äºŒä¸­åˆ 12:15', likes:7, replies:[]},
          {who:'é åŒ—æ˜Ÿç¿ 9464', text:'#åˆé¤åƒä»€éº¼\nå¤–é€è¨‚äº†é¦™è¾£é›è…¿å ¡ï¼Œçµæœè¾£æ²¹åªæ»´äº†ä¸€æ»´åœ¨é›çš®ä¸Šï¼Œé‚„ä¸å¦‚å«æ°´ç…®é¤ã€‚å¥½æ°£ï¼', time:'ä¸Šé€±ä¸€ä¸­åˆ 1:00', likes:3, replies:[]}
Â  Â  Â  Â  ];
        // æµæ°´è™Ÿèµ·å§‹å€¼
        let nextPostId = 9487;

        const postsEl = document.getElementById('posts');
        const qEl = document.getElementById('q');
    
        function processContent(text) {
            let safeText = escapeHtml(text);
            safeText = safeText.replace(/(?:^|\s)(#[\w\u4e00-\u9fa5]+)/g, (match, tag) => {
                const prefix = match.startsWith('#') ? '' : ' ';
                return `${prefix}<span class="badge">${tag}</span>`;
            });
            return safeText;
        }

        function renderPosts(list){
         postsEl.innerHTML = '';
         list.forEach((p, idx)=>{
           const div = document.createElement('div');
           div.className = 'post';
           div.innerHTML = `
             <div class="top"><div class="avatar" style="width:36px;height:36px;border-radius:6px">#</div>
               <div>
                 <div><span class="who">${escapeHtml(p.who)}</span><span class="time"> Â· ${p.time}</span></div>
               </div>
             </div>
             <div class="content">${processContent(p.text)}</div> 
             <div class="actions">
               <button class="like" data-i="${idx}">â¤ <span class="count">${p.likes}</span></button>
               <button class="replyBtn" data-i="${idx}">ğŸ’¬ å›è¦†</button>
               <button class="share" data-i="${idx}">â¤´ åˆ†äº«</button>
               ${p.isOwner ? `<button class="deleteBtn" data-i="${idx}" style="color:var(--danger);margin-left:auto;font-weight:600;">ğŸ—‘ï¸ åˆªé™¤</button>` : ''}
             </div>
             <div class="reply-list" id="replies-${idx}"></div>
           `;
           postsEl.appendChild(div);
         });
         attachEvents(list);
        }
    
        function attachEvents(list){
         document.querySelectorAll('.like').forEach(btn=>{
           btn.onclick = ()=>{
             const i = btn.dataset.i;
             list[i].likes++;
             btn.querySelector('.count').textContent = list[i].likes;
             btn.classList.add('active');
           };
         });
         document.querySelectorAll('.replyBtn').forEach(b=>{
           b.onclick = ()=>{
             const i = b.dataset.i;
             const r = prompt('åŒ¿åå›è¦†ï¼š');
             if(r) {
               list[i].replies.push(r); 
               renderReply(i, list);
             }
           }
         });
         document.querySelectorAll('.share').forEach(b=>{
           b.onclick = ()=>alert('åˆ†äº«åŠŸèƒ½åƒ…ç¤ºç¯„ç”¨ï¼ˆæœ¬åœ°ï¼‰');
         });

         document.querySelectorAll('.deleteBtn').forEach(btn => {
            btn.onclick = () => {
                const i = btn.dataset.i;
                if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å‰‡è²¼æ–‡å—ï¼Ÿ')) {
                    const postToDelete = list[i];
                    const originalIndex = sample.findIndex(p => p === postToDelete);
                    if (originalIndex > -1) {
                        sample.splice(originalIndex, 1);
                    }
                    // ğŸŒŸ ä¿®æ”¹é»ï¼šå‘¼å« clearSearchFilter
                    clearSearchFilter();
                }
            }
        });

        document.querySelectorAll('.post .content .badge').forEach(badge => {
            badge.onclick = () => {
                const tag = badge.textContent.trim();
                qEl.value = tag;
                document.getElementById('btnSearch').click();
            };
        });
        }
    
        function renderReply(i, list){
         const container = document.getElementById('replies-'+i);
         container.innerHTML = '';
         list[i].replies.forEach(r=>{
           const el = document.createElement('div');
           el.className = 'reply';
           el.textContent = r;
           container.appendChild(el);
         });
        }
    
        // escape
        function escapeHtml(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }
        

        // -----------------------------------------------------------------
        // ğŸŒŸ æ–°å¢é» 4: é¡¯ç¤ºç¯©é¸æ¢ä»¶çš„å‡½å¼
        // -----------------------------------------------------------------
        function showFilterDisplay(q) {
            const filterEl = document.getElementById('filter-display');
            filterEl.innerHTML = `
                <span>ç¯©é¸æ¢ä»¶ï¼š</span>
                <span class="badge">${escapeHtml(q)}</span>
                <button id="clearSearchBtn" class="cancel-btn" title="æ¸…é™¤ç¯©é¸">X</button>
            `;
            filterEl.style.display = 'flex';
            // ç¶å®šæ¸…é™¤æŒ‰éˆ•
            document.getElementById('clearSearchBtn').onclick = clearSearchFilter;
        }

        // -----------------------------------------------------------------
        // ğŸŒŸ æ–°å¢é» 5: æ¸…é™¤ç¯©é¸çš„å‡½å¼ (å¤šè™•å…±ç”¨)
        // -----------------------------------------------------------------
        function clearSearchFilter() {
            const filterEl = document.getElementById('filter-display');
            filterEl.innerHTML = '';
            filterEl.style.display = 'none';
            qEl.value = '';
            renderPosts(sample); // é‡æ–°æ¸²æŸ“å®Œæ•´åˆ—è¡¨
        }

        // init
        renderPosts(sample);
    
        // -----------------------------------------------------------------
        // ğŸŒŸ æ–°å¢é» 6: è®“å´é‚Šæ¬„çš„ç†±é–€æ¨™ç±¤å¯é»æ“Š (åªéœ€ç¶å®šä¸€æ¬¡)
        // -----------------------------------------------------------------
        document.querySelectorAll('aside .badge').forEach(badge => {
            badge.onclick = () => {
                const tag = badge.textContent.trim();
                qEl.value = tag;
                document.getElementById('btnSearch').click();
            };
        });

        // -----------------------------------------------------------------
        // ğŸŒŸ ä¿®æ”¹é» 7: ç™¼æ–‡æŒ‰éˆ•
        // -----------------------------------------------------------------
        document.getElementById('postBtn').onclick = ()=>{
         const txt = document.getElementById('postText').value.trim();
         if(!txt){ alert('è«‹è¼¸å…¥å…§å®¹'); return; }

         const categoryEl = document.getElementById('category');
         const category = categoryEl.value;
         let postTextWithTag = txt;

         if (category !== 'æ—¥å¸¸' && category !== 'å…¶ä»–') {
             postTextWithTag = `#${category}\n\n${txt}`;
         }

         const newPost = {
            who: 'é åŒ—æ˜Ÿç¿ ' + nextPostId,
            text: postTextWithTag,
            time: 'å‰›å‰›', 
            likes: 0, 
            replies: [], 
            isOwner: true
         };
         nextPostId++;

         sample.unshift(newPost);
         
         document.getElementById('postText').value='';
         categoryEl.selectedIndex = 0;
         
         // ğŸŒŸ ä¿®æ”¹é»ï¼šå‘¼å« clearSearchFilter
         clearSearchFilter();
        };
    
        // æ–°å¢è¡¨å–®å¿«é€Ÿéµ
        document.getElementById('btnNew').onclick = ()=>document.getElementById('postText').focus();
    
        // -----------------------------------------------------------------
        // ğŸŒŸ ä¿®æ”¹é» 8: æœå°‹æŒ‰éˆ•
        // -----------------------------------------------------------------
        document.getElementById('btnSearch').onclick = ()=>{
         const q = qEl.value.trim().toLowerCase();
         if(!q){ 
            clearSearchFilter(); // å¦‚æœæœå°‹ç‚ºç©ºï¼Œä¹Ÿå‘¼å«æ¸…é™¤
            return; 
         }
         // æœå°‹æ™‚ï¼ŒåŒæ™‚æª¢æŸ¥ p.text å’Œ p.who
         const filtered = sample.filter(p=>p.text.toLowerCase().includes(q) || p.who.toLowerCase().includes(q));
         renderPosts(filtered);
         // ğŸŒŸ é¡¯ç¤ºç¯©é¸æ¢ä»¶ (å‚³å…¥åŸå§‹ qEl.value ä»¥ä¿ç•™å¤§å°å¯«)
         showFilterDisplay(qEl.value.trim()); 
        };
    
        // Enter æœå°‹
        qEl.addEventListener('keydown',(e)=>{ if(e.key==='Enter') document.getElementById('btnSearch').click(); });
    </script>
</body>

</html>

